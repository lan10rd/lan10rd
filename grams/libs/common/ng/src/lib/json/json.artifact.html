<ul
>

    <common-ng-button-element
    style="width: fit-content"
    class="bl hover"
    [text]="'...'"
    #dotdotdot
    ></common-ng-button-element>

    <ng-container
    *ngIf="dotdotdot.toggle"
    >

        <ng-container
        [ngSwitch]="type"
        >

            <ng-container
            *ngSwitchCase="'obj'"
            >
                <div
                class="flex"
                >
                    <input
                    [(ngModel)]="inputs.addKey"
                    >
                    <button
                    (click)="addKey()"
                    >
                        add key
                    </button>
                </div>
            </ng-container>

            <ng-container
            *ngSwitchCase="'arr'"
            >
                <common-ng-select-element
                [options]="['add', 'remove', 'swap']"
                ></common-ng-select-element>
            </ng-container>

        </ng-container>

    </ng-container>

<ng-container
*ngFor="let key of keys; let i=index; trackBy: json.trackBy"
>


        <li>
            <div
            [ngClass]="{'hover': type === 'obj'}"
            *ngIf="!editing.keys.includes(key)"
            (click)="toggleEditKey(key)"
            (keyup.enter)="toggleEditKey(key)"
            style="width: fit-content"
            tabindex="0"
            >
                {{key}} 
            </div>
            <div
            [ngClass]="{'hidden': !editing.keys.includes(key)}"
            >

                <input
                class="bl"
                #keysi
                (focusout)="editing.keys = json.remove(editing.keys, key)"
                [ngModel]="keys[i]"
                (keyup.enter)="editing.keys = json.remove(editing.keys, key); changeKey(keysi.value, i)"
                >
                
                <select (change)="handleMode(modeSelect.value, key);" #modeSelect>
                    <option [ngValue]="'pretty'">pretty</option>
                    <option [ngValue]="'raw'">raw</option>
                </select>

                <button (click)="model[key] = json.parse(editing.values[key])" *ngIf="modeSelect.value === 'raw'">save</button>

                
            </div>

            <ng-container
            [ngSwitch]="modeSelect.value"
            >
            
                <ng-container
                *ngSwitchCase="'pretty'"
                >
                    <ng-container
                    [ngSwitch]="json.typeOf(model[key])"
                    >

                        <!-- <input
                        *ngSwitchCase="'str'"
                        [(ngModel)]="model[key]"
                        placeholder="{{key}}"
                        > -->

                        <textarea
                        *ngSwitchCase="'str'"
                        [(ngModel)]="model[key]"
                        ></textarea>

                        <input
                        *ngSwitchCase="'num'"
                        [(ngModel)]="model[key]"
                        type="number"
                        >

                        <ng-container
                        *ngSwitchCase="'boo'"
                        >
                            {{model[key]}}
                        </ng-container>

                        <common-ng-json-artifact
                        *ngSwitchDefault
                        [(model)]="model[key]"
                        ></common-ng-json-artifact>

                    </ng-container>
                </ng-container>

                <ng-container
                *ngSwitchCase="'raw'"
                >

                    <textarea
                    [(ngModel)]="editing.values[key]"
                    ></textarea>

                </ng-container>

            </ng-container>

        </li>

</ng-container>
</ul>