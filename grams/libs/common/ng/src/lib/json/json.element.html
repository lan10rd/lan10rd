<!-- <ul
*ngFor = "let list of model | keyvalue; let i=index"
>
    <li>
        {{list.key}}

        <ng-container
        [ngSwitch]="json.typeOf(list.value)"
        >

            <input
            *ngSwitchCase="'str'"
            [(ngModel)]="list.value"
            placeholder="{{list.key}}"
            >

            <input
            *ngSwitchCase="'num'"
            [(ngModel)]="list.value"
            type="number"
            >

            <ng-container
            *ngSwitchCase="'boo'"
            >
                {{list.value}}
            </ng-container>

            <common-ng-json-element
            *ngSwitchDefault
            [(model)]="list.value"
            ></common-ng-json-element>

        </ng-container>

    </li>
</ul> -->

<ng-container
*ngFor="let key of keys; let i=index; trackBy: json.trackBy"
>
<!-- <ng-template
let-mode="mode"
[ngTemplateOutletContext]="{mode: 'pretty'}"
> -->
<ul
>

    <li>
        <ng-container
        [ngSwitch]="type"
        >
            <ng-container
            >
            </ng-container>
        </ng-container>
        <div
        *ngIf="!editing.keys.includes(key)"
        (click)="editing.keys.push(key)"
        >
            {{key}} 
        </div>
        <div
        [ngClass]="{'hidden': !editing.keys.includes(key)}"
        >
            <input
            class="bl"
            #keysi
            (focusout)="editing.keys = json.remove(editing.keys, key)"
            [ngModel]="keys[i]"
            (keyup.enter)="editing.keys = json.remove(editing.keys, key); changeKey(keysi.value, i)"
            >
            
            <select (ngModelChange)="handleMode($event, key);" #modeSelect>
                <option [ngValue]="'pretty'">pretty</option>
                <option [ngValue]="'raw'">raw</option>
            </select>

            <button (click)="model[key] = json.parse(editing.values[key])" *ngIf="modeSelect.value === 'raw'">save</button>

            <button>add</button>
        </div>

        <ng-container
        [ngSwitch]="modeSelect.value"
        >
        
            <ng-container
            *ngSwitchCase="'pretty'"
            >
                <ng-container
                [ngSwitch]="json.typeOf(model[key])"
                >

                    <!-- <input
                    *ngSwitchCase="'str'"
                    [(ngModel)]="model[key]"
                    placeholder="{{key}}"
                    > -->

                    <textarea
                    *ngSwitchCase="'str'"
                    [(ngModel)]="model[key]"
                    ></textarea>

                    <input
                    *ngSwitchCase="'num'"
                    [(ngModel)]="model[key]"
                    type="number"
                    >

                    <ng-container
                    *ngSwitchCase="'boo'"
                    >
                        {{model[key]}}
                    </ng-container>

                    <common-ng-json-element
                    *ngSwitchDefault
                    [(model)]="model[key]"
                    ></common-ng-json-element>

                </ng-container>
            </ng-container>

            <ng-container
            *ngSwitchCase="'raw'"
            >

                <textarea
                [(ngModel)]="editing.values[key]"
                ></textarea>

            </ng-container>

        </ng-container>

    </li>
</ul>
<!-- </ng-template> -->
</ng-container>